name: NotificaÃ§Ã£o de Pull Request

on:
  pull_request:
    branches: [main]

jobs:
  discord:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: ContruÃ§Ã£o da notificaÃ§Ã£o
        id: payload
        run: |
          echo '{
            "content": "ðŸ“¢ **Novo Pull Request Criado ou Atualizado!**",
            "embeds": [
              {
                "title": "Detalhes do Pull Request",
                "description": "Um novo Pull Request foi aberto no repositÃ³rio '${{ github.repository }}'.",
                "color": 16753920,
                "fields": [
                  {
                    "name": "Autor",
                    "value": "'${{ github.actor }}'",
                    "inline": true
                  },
                  {
                    "name": "TÃ­tulo do PR",
                    "value": "'${{ github.event.pull_request.title }}'",
                    "inline": true
                  },
                  {
                    "name": "DescriÃ§Ã£o",
                    "value": "'${{ github.event.pull_request.body || 'Sem descriÃ§Ã£o fornecida.' }}'",
                    "inline": false
                  },
                  {
                    "name": "Branch Origem",
                    "value": "'${{ github.event.pull_request.head.ref }}'",
                    "inline": true
                  },
                  {
                    "name": "Branch Destino",
                    "value": "'${{ github.event.pull_request.base.ref }}'",
                    "inline": true
                  }
                ],
                "footer": {
                  "text": "NotificaÃ§Ã£o AutomÃ¡tica - Pull Request"
                },
                "timestamp": "'${{ github.event.pull_request.updated_at }}'"
              }
            ]
          }' > payload.json
      - name: Discord Webhook Action
        uses: tsickert/discord-webhook@v7.0.0
        with:
          webhook-url: ${{ secrets.PR_WEBHOOK }}
          raw-data: payload.json